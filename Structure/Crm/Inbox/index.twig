<div class="col-xs-3">
    <table class="table table-striped table-hover">
        {% for item in inbox %}
            <tr class="order-{{ item.ID }}">
            <td {% if ID == item.ID %}class="active"{% endif %}>
                {% if item.contact_person %}
                    <span class="glyphicon glyphicon-certificate" style="color:#00bf1c;"></span>
                {% endif %}
                <a href="index.php?par={{ par }}-{{ item.ID }}" title="{{ item.info }}"
                   onclick="showOrder('{{ par }}', '{{ item.ID }}', 'showData'); return false;">
                    {% if item.name %}{{ item.name }}<br />{% endif %}
                    {% if item.phone %}{{ item.phone }}<br />{% endif %}
                    {% if item.email %}{{ item.email }}<br />{% endif %}
                    {{ item.date_create_str }}
                </a>
            </td>
            </tr>
        {% endfor %}
    </table>
</div>
<div class="col-xs-6">
    <div class="lead-content" style="display: none;"></div>
</div>
<script type="text/javascript">
    function showOrder(par, id, action)
    {
        dataToAjax = {action: action, par: par, id: id};

        $.ajax({
            url: 'index.php',
            data: dataToAjax,
            success: function (data)
            {
                if ('data' in data && 'content' in data.data) {
                    $('.lead-content').show();

                    var relatedData = 'orderId-' + id;
                    var contactInfo = '<br />';

                    var contactContent = '';
                    if ('contact_person' in data.data && parseInt(data.data.contact_person) === 0) {
                        {% if contactPersonStructureId is defined %}
                        contactContent += '<button class="btn" title="Создать/привязать к контакту" ' +
                            'onclick="showModal(' +
                            '\'{{ contactPersonStructureId }}\', \'0\', \'showCreate\', \'' + relatedData + '\');">\n' +
                            '<span class="glyphicon glyphicon-user"></span>\n' +
                            '</button>\n';
                        {% endif %}
                    }

                    if ('name' in data.data) {
                        contactInfo += 'Имя - ' + data.data.name + '<br />'
                    }

                    if ('email' in data.data) {
                        contactInfo += 'E-mail - ' + data.data.email + '<br />'
                    }

                    if ('phone' in data.data) {
                        contactInfo += 'Телефон - ' + data.data.phone + '<br />'
                    }

                    // Дополняем контент заявки кнопками
                    var content = '<div class="btn-group btn-group-xs button-edit">\n' +
                        '<button class="btn btn-info" title="Изменить" ' +
                        'onclick="showModal(\'' + par + '\', \'' + id + '\', \'showEdit\');" style="width: 47px;">\n' +
                        '<span class="glyphicon glyphicon-pencil"></span>\n' +
                        '</button>\n' +
                        '<button class="btn btn-danger" title="Удалить" ' +
                        'onclick="showDeleteConfirm(\'' + par + '\', \'' + id + '\');">\n' +
                        '<span class="glyphicon glyphicon-remove"></span>\n' +
                        '</button>\n' + contactContent +
                        '</div>' + contactInfo + data.data.content;
                    $('.lead-content').html(content);
                }
            },
            type: 'GET',
            dataType: "json"
        });

    }
</script>